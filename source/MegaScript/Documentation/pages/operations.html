<html>
<head>
<title>Operations</title>
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/table.css">
</head>
<body>
<div class="page">
  <h3>Links</h3>
  <a href="../index.html">Index</a>
  <div class="title">
    <h1>Operation Formatting</h1>
    <p>MegaScript operations can be very confusing if you don't know how they work, so this will explain in detail how they function!</p>
  </div>
  <h2>Operation Saves</h2>
  <p>Before I had added user-created functions, operations were done simply by running ExecuteMegaScriptOperation from inside that same function whenever an operator with higher precedence was reached, or a bracket was 
  entered. I found that this would not be compatible with user created functions since a user function would require its own amount of operation/statement cycles in order
  to be called. So I came up with a solution: Operation saves.</p>
          
  <p>Operation saves are a concept that I came up with specifically for the MegaScript language.
  When an operation is interrupted to enter a bracket, call a function, or simply postpone for a higher precedence, it will push an operation save onto the
  script's stack so that once that interrupt is returned back to. It restores the operation to its former state. Operation saves are 32 bit unsigned integers.
  If you're curious about how an operation save is formatted, here's a table of what each bit of the save means:</p>

  <center>
    <table>
      <tr>
        <th>Operator count</th>
        <th>Bytecode save</th>
        <th>StopAtCommas</th>
        <th>IsLoop</th>
        <th>IsFunctionArgument</th>
        <th>IsCallReturn</th>
        <th>HasFunctionCall</th>
        <th>IsPrimitiveOnly</th>
        <th>ResumePrevious</th>
        <th>HasReturn</th>
      </tr>
      <tr>
        <td>0000000000000000</td>
        <td>00000000</th>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
    </table>
  </center>

  <p>All together, they form the 32 bit operation save, which can then be pushed onto the stack for later use.

  Alongside the regular script stack, there is also an operator storage stack which is stored in the script system. It behaves almost identically to the regular
  script stack, except it does not need data types to be pushed on since every element will always just be 1 byte. When an operation is restored, the operator
  count is analyzed, which then lets the program know how far into the operation the script was.</p>

  <hr>

  <h2>Precedence</h2>

  <p>As of Update 1.4.0 Indev, operator precedence is formatted similar to the way that C operator precedence is defined. Each precedence level has
  a group of operators that share that precedence level. These are called precedence groups. Each precedence group has an associativity value which can
  be left-to-right, or right-to-left. All that this associativity value does is change which direction the operators of that group are executed.</p>

  <p>When you create a new script environment, it automatically creates a list called "operator_info." This list is an array of 256 OperatorInformation structs
  that are 4 bytes large. (The array is 1024 bytes in total.) The reason it creates a member for every single possible byte is so that the members can
  be indexed by the byte number rather than having to search for the array member for that bytecode/operator, which makes the program run much faster.</p>

  <p>Here's a table of all the precedence groups ordered from highest precedence to lowest:</p>

  <center>
    <table>
      <tbody>
        <tr>
          <th>Precedence</th>
          <th>Operator</th>
          <th>Bytecode</th>
          <th>Description</th>
          <th>Associativity</th>
        </tr>
        <tr>
          <th rowspan="10">1</th>
          <td>(</td>
          <td><a href="bytecodes/26.html">26</a></td>
          <td>Opening parenthesis</td>
          <td rowspan="11">Left-to-right</td>
        </tr>
        <tr>
          <td>)</td>
          <td><a href="bytecodes/27.html">27</a></td>
          <td>Closing parenthesis</td>
        </tr>
        <tr>
          <td>++</td>
          <td><a href="bytecodes/28.html">28</a></td>
          <td>Increment suffix</td>
        </tr>
        <tr>
          <td>--</td>
          <td><a href="bytecodes/29.html">29</a></td>
          <td>Decrement suffix</td>
        </tr>
        <tr>
          <td>[</td>
          <td><a href="bytecodes/2A.html">2A</a></td>
          <td>Opening array bracket</td>
        </tr>
        <tr>
          <td>]</td>
          <td><a href="bytecodes/2B.html">2B</a></td>
          <td>Closing array bracket</td>
        </tr>
        <tr>
          <td>{</td>
          <td><a href="bytecodes/2C.html">2C</a></td>
          <td>Opening dynamic bracket</td>
        </tr>
        <tr>
          <td>}</td>
          <td><a href="bytecodes/2D.html">2D</a></td>
          <td>Closing dynamic bracket</td>
        </tr>
        <tr>
          <td>.</td>
          <td><a href="bytecodes/2E.html">2E</a></td>
          <td>Union connector</td>
        </tr>
        <tr>
          <td>-></td>
          <td><a href="bytecodes/2F.html">2F</a></td>
          <td>Pointer connector</td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th rowspan="9">2</th>
          <td>++</td>
          <td><a href="bytecodes/30.html">30</a></td>
          <td>Increment prefix</td>
          <td rowspan="9">Right-to-left</td>
        </tr>
        <tr>
          <td>--</td>
          <td><a href="bytecodes/31.html">31</a></td>
          <td>Decrement prefix</td>
        </tr>
        <tr>
          <td>+</td>
          <td><a href="bytecodes/32.html">32</a></td>
          <td>Unary plus</td>
        </tr>
        <tr>
          <td>-</td>
          <td><a href="bytecodes/33.html">33</a></td>
          <td>Unary negative</td>
        </tr>
        <tr>
          <td>!</td>
          <td><a href="bytecodes/34.html">34</a></td>
          <td>Logical not</td>
        </tr>
        <tr>
          <td>~</td>
          <td><a href="bytecodes/35.html">35</a></td>
          <td>Bitwise not</td>
        </tr>
        <tr>
          <td>$</td>
          <td><a href="bytecodes/37.html">37</a></td>
          <td>Dereference</td>
        </tr>
        <tr>
          <td>@</td>
          <td><a href="bytecodes/38.html">38</a></td>
          <td>Address of</td>
        </tr>
        <tr>
          <td>(type)</td>
          <td><a href="bytecodes/6A.html">6A</a></td>
          <td>Type cast</td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th>3</th>
          <td>*</td>
          <td><a href="bytecodes/3A.html">3A</a></td>
          <td>Multiply</td>
          <td rowspan="21">Left-to-right</td>
        </tr>
        <tr>
          <th>4</th>
          <td>/</td>
          <td><a href="bytecodes/3B.html">3B</a></td>
          <td>Divide</td>
        </tr>
        <tr>
          <th>5</th>
          <td>%</td>
          <td><a href="bytecodes/3C.html">3C</a></td>
          <td>Modulus/remainder</td>
        </tr>
        <tr>
          <th>6</th>
          <td>+</td>
          <td><a href="bytecodes/3D.html">3D</a></td>
          <td>Add</td>
        </tr>
        <tr>
          <th>7</th>
          <td>-</td>
          <td><a href="bytecodes/3E.html">3E</a></td>
          <td>Subtract</td>
        </tr>
        <tr>
          <th rowspan="2">8</th>
          <td><<</td>
          <td><a href="bytecodes/3F.html">3F</a></td>
          <td>Bitwise shift left</td>
        </tr>
        <tr>
          <td>>></td>
          <td><a href="bytecodes/40.html">40</a></td>
          <td>Bitwise shift right</td>
        </tr>
        <tr>
          <th rowspan="4">9</th>
          <td><</td>
          <td><a href="bytecodes/41.html">41</a></td>
          <td>Less than</td>
        </tr>
        <tr>
          <td>></td>
          <td><a href="bytecodes/43.html">43</a></td>
          <td>Greater than</td>
        </tr>
        <tr>
          <td>>=</td>
          <td><a href="bytecodes/44.html">44</a></td>
          <td>Greater than or equal to</td>
        </tr>
        <tr>
          <td><=</td>
          <td><a href="bytecodes/42.html">42</a></td>
          <td>Less than or equal to</td>
        </tr>
        <tr>
          <th rowspan="2">10</th>
          <td>==</td>
          <td><a href="bytecodes/45.html">45</a></td>
          <td>Equal to</td>
        </tr>
        <tr>
          <td>!=</td>
          <td><a href="bytecodes/46.html">46</a></td>
          <td>Not equal to</td>
        </tr>
        <tr>
          <th>11</th>
          <td>&</td>
          <td><a href="bytecodes/47.html">47</a></td>
          <td>Bitwise AND</td>
        </tr>
        <tr>
          <th>12</th>
          <td>^</td>
          <td><a href="bytecodes/48.html">48</a></td>
          <td>Bitwise XOR</td>
        </tr>
        <tr>
          <th>13</th>
          <td>|</td>
          <td><a href="bytecodes/49.html">49</a></td>
          <td>Bitwise OR</td>
        </tr>
        <tr>
          <th>14</th>
          <td>&&</td>
          <td><a href="bytecodes/4A.html">4A</a></td>
          <td>Logical and</td>
        </tr>
        <tr>
          <th>15</th>
          <td>||</td>
          <td><a href="bytecodes/4B.html">4B</a></td>
          <td>Logical or</td>
        </tr>
        <tr>
          <th>16</th>
          <td>&&&</td>
          <td><a href="bytecodes/4C.html">4C</a></td>
          <td>Intelligent and</td>
        </tr>
        <tr>
          <th rowspan="2">17</th>
          <td>?</td>
          <td><a href="bytecodes/4E.html">4E</a></td>
          <td>Ternary prompt</td>
        </tr>
        <tr>
          <td>:</td>
          <td><a href="bytecodes/4F.html">4F</a></td>
          <td>Ternary switch</td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th rowspan="11">18</th>
          <td>=</td>
          <td><a href="bytecodes/50.html">50</a></td>
          <td>Assign</td>
          <td rowspan="11">Right-to-left</td>
        </tr>
        <tr>
          <td>+=</td>
          <td><a href="bytecodes/51.html">51</a></td>
          <td>Add and assign</td>
        </tr>
        <tr>
          <td>-=</td>
          <td><a href="bytecodes/52.html">52</a></td>
          <td>Subtract and assign</td>
        </tr>
        <tr>
          <td>*=</td>
          <td><a href="bytecodes/53.html">53</a></td>
          <td>Multiply and assign</td>
        </tr>
        <tr>
          <td>/=</td>
          <td><a href="bytecodes/54.html">54</a></td>
          <td>Multiply and assign</td>
        </tr>
        <tr>
          <td>%=</td>
          <td><a href="bytecodes/55.html">55</a></td>
          <td>Modulus and assign</td>
        </tr>
        <tr>
          <td><<=</td>
          <td><a href="bytecodes/56.html">56</a></td>
          <td>Shift left and assign</td>
        </tr>
        <tr>
          <td>>>=</td>
          <td><a href="bytecodes/57.html">57</a></td>
          <td>Shift right and assign</td>
        </tr>
        <tr>
          <td>&=</td>
          <td><a href="bytecodes/58.html">58</a></td>
          <td>Bitwise AND and assign</td>
        </tr>
        <tr>
          <td>^=</td>
          <td><a href="bytecodes/59.html">59</a></td>
          <td>Bitwise XOR and assign</td>
        </tr>
        <tr>
          <td>|=</td>
          <td><a href="bytecodes/59.html">59</a></td>
          <td>Bitwise OR and assign</td>
        </tr>
        <tr>
          <th>19</th>
          <td>,</td>
          <td><a href="bytecodes/5B.html">5B</a></td>
          <td>Comma/seperator</td>
          <td>Left-to-right</td>
        </tr>
      </tbody>
    </table>
  </center>

  <br>

</div>
</body>
</html>
